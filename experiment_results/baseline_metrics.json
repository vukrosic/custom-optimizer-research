{
  "experiment_name": "baseline",
  "start_time": "2025-12-06T08:34:28.313608",
  "steps": [
    {
      "step": 20,
      "train_loss": 9.961953258514404,
      "tokens_per_sec": 50783.924974012945,
      "lr_embedding": 0.0003,
      "lr_attention": 0.02,
      "lr_ffn": 0.02,
      "lr_norm": 0.0003
    },
    {
      "step": 40,
      "train_loss": 7.988274574279785,
      "tokens_per_sec": 86334.80789919254,
      "lr_embedding": 0.0002909539103507995,
      "lr_attention": 0.01939692735671997,
      "lr_ffn": 0.01939692735671997,
      "lr_norm": 0.0002909539103507995
    },
    {
      "step": 60,
      "train_loss": 7.250974774360657,
      "tokens_per_sec": 86352.7952419147,
      "lr_embedding": 0.00026490672826766967,
      "lr_attention": 0.01766044855117798,
      "lr_ffn": 0.01766044855117798,
      "lr_norm": 0.00026490672826766967
    },
    {
      "step": 80,
      "train_loss": 6.967915749549865,
      "tokens_per_sec": 86317.40268053248,
      "lr_embedding": 0.0002250001162290573,
      "lr_attention": 0.01500000774860382,
      "lr_ffn": 0.01500000774860382,
      "lr_norm": 0.0002250001162290573
    },
    {
      "step": 100,
      "train_loss": 6.765927410125732,
      "tokens_per_sec": 86072.92272779594,
      "lr_embedding": 0.00017604740783572196,
      "lr_attention": 0.011736493855714798,
      "lr_ffn": 0.011736493855714798,
      "lr_norm": 0.00017604740783572196,
      "token_embedding.weight_spectral": 56.986324310302734,
      "layers.0.attention.qkv.weight_spectral": 2.0322470664978027,
      "layers.0.attention.out_proj.weight_spectral": 1.167164921760559,
      "layers.0.feed_forward.w1.weight_spectral": 2.488420009613037,
      "layers.0.feed_forward.w2.weight_spectral": 1.5520126819610596,
      "layers.0.feed_forward.w3.weight_spectral": 2.5322985649108887,
      "layers.1.attention.qkv.weight_spectral": 2.30062198638916,
      "layers.1.attention.out_proj.weight_spectral": 1.2979021072387695,
      "layers.1.feed_forward.w1.weight_spectral": 2.479578733444214,
      "layers.1.feed_forward.w2.weight_spectral": 1.5416839122772217,
      "layers.1.feed_forward.w3.weight_spectral": 2.5505287647247314,
      "layers.2.attention.qkv.weight_spectral": 2.4200100898742676,
      "layers.2.attention.out_proj.weight_spectral": 1.41475510597229,
      "layers.2.feed_forward.w1.weight_spectral": 2.5750515460968018,
      "layers.2.feed_forward.w2.weight_spectral": 1.5128816366195679,
      "layers.2.feed_forward.w3.weight_spectral": 2.5870914459228516,
      "layers.3.attention.qkv.weight_spectral": 2.470566987991333,
      "layers.3.attention.out_proj.weight_spectral": 1.4609332084655762,
      "layers.3.feed_forward.w1.weight_spectral": 2.625502109527588,
      "layers.3.feed_forward.w2.weight_spectral": 1.5760204792022705,
      "layers.3.feed_forward.w3.weight_spectral": 2.6533384323120117,
      "embedding_frob_mean": 115.26951599121094,
      "embedding_frob_max": 115.26951599121094,
      "attention_frob_mean": 26.029664754867554,
      "attention_frob_max": 36.29004669189453,
      "ffn_frob_mean": 38.28201866149902,
      "ffn_frob_max": 46.750694274902344,
      "norm_frob_mean": 22.67187605963813,
      "norm_frob_max": 23.051467895507812
    },
    {
      "step": 120,
      "train_loss": 6.657802605628968,
      "tokens_per_sec": 85968.06664327296,
      "lr_embedding": 0.00012395298331975937,
      "lr_attention": 0.008263532221317291,
      "lr_ffn": 0.008263532221317291,
      "lr_norm": 0.00012395298331975937
    },
    {
      "step": 140,
      "train_loss": 6.476158452033997,
      "tokens_per_sec": 85969.31419559094,
      "lr_embedding": 7.500024139881133e-05,
      "lr_attention": 0.00500001609325409,
      "lr_ffn": 0.00500001609325409,
      "lr_norm": 7.500024139881133e-05
    },
    {
      "step": 160,
      "train_loss": 6.449626803398132,
      "tokens_per_sec": 85951.49699079916,
      "lr_embedding": 3.509353995323181e-05,
      "lr_attention": 0.002339569330215454,
      "lr_ffn": 0.002339569330215454,
      "lr_norm": 3.509353995323181e-05
    },
    {
      "step": 180,
      "train_loss": 6.412021803855896,
      "tokens_per_sec": 85879.81899615575,
      "lr_embedding": 9.046232700347899e-06,
      "lr_attention": 0.0006030821800231934,
      "lr_ffn": 0.0006030821800231934,
      "lr_norm": 9.046232700347899e-06
    },
    {
      "step": 200,
      "train_loss": 6.399925994873047,
      "tokens_per_sec": 85841.34935833976,
      "lr_embedding": 0.0,
      "lr_attention": 0.0,
      "lr_ffn": 0.0,
      "lr_norm": 0.0,
      "token_embedding.weight_spectral": 67.4830322265625,
      "layers.0.attention.qkv.weight_spectral": 2.2190120220184326,
      "layers.0.attention.out_proj.weight_spectral": 1.2653471231460571,
      "layers.0.feed_forward.w1.weight_spectral": 2.7206239700317383,
      "layers.0.feed_forward.w2.weight_spectral": 1.6306170225143433,
      "layers.0.feed_forward.w3.weight_spectral": 2.719882011413574,
      "layers.1.attention.qkv.weight_spectral": 2.3789148330688477,
      "layers.1.attention.out_proj.weight_spectral": 1.490536093711853,
      "layers.1.feed_forward.w1.weight_spectral": 2.7583413124084473,
      "layers.1.feed_forward.w2.weight_spectral": 1.626273512840271,
      "layers.1.feed_forward.w3.weight_spectral": 2.7642788887023926,
      "layers.2.attention.qkv.weight_spectral": 2.630516290664673,
      "layers.2.attention.out_proj.weight_spectral": 1.5830785036087036,
      "layers.2.feed_forward.w1.weight_spectral": 2.7189700603485107,
      "layers.2.feed_forward.w2.weight_spectral": 1.5707359313964844,
      "layers.2.feed_forward.w3.weight_spectral": 2.752315044403076,
      "layers.3.attention.qkv.weight_spectral": 2.6133079528808594,
      "layers.3.attention.out_proj.weight_spectral": 1.5825483798980713,
      "layers.3.feed_forward.w1.weight_spectral": 2.794034242630005,
      "layers.3.feed_forward.w2.weight_spectral": 1.6343817710876465,
      "layers.3.feed_forward.w3.weight_spectral": 2.8252158164978027,
      "embedding_frob_mean": 120.8582992553711,
      "embedding_frob_max": 120.8582992553711,
      "attention_frob_mean": 27.802772521972656,
      "attention_frob_max": 38.6263542175293,
      "ffn_frob_mean": 40.16902764638265,
      "ffn_frob_max": 49.51811599731445,
      "norm_frob_mean": 22.69209098815918,
      "norm_frob_max": 23.1864070892334
    },
    {
      "step": 200,
      "val_loss": 6.334638357162476,
      "perplexity": 563.7654843649734
    }
  ],
  "config": {
    "name": "baseline",
    "description": "Muon for 2D weight matrices, AdamW for embeddings & norms",
    "max_steps": 200,
    "batch_size": 16,
    "hidden_size": 512,
    "num_layers": 4,
    "embedding_optimizer": "adamw",
    "embedding_lr": 0.0003,
    "attention_optimizer": "muon",
    "attention_lr": 0.02,
    "ffn_optimizer": "muon",
    "ffn_lr": 0.02
  },
  "final_val_loss": 6.336882023101158,
  "final_perplexity": 565.0318058496132,
  "end_time": "2025-12-06T08:35:46.286355"
}