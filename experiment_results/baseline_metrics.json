{
  "experiment_name": "baseline",
  "start_time": "2025-12-06T08:16:39.105820",
  "steps": [
    {
      "step": 2,
      "train_loss": 10.751867771148682,
      "tokens_per_sec": 10501.416943505095,
      "lr_embedding": 0.0003,
      "lr_attention": 0.02,
      "lr_ffn": 0.02,
      "lr_norm": 0.0003
    },
    {
      "step": 4,
      "train_loss": 10.334210872650146,
      "tokens_per_sec": 86462.43251173267,
      "lr_embedding": 0.0002909539103507995,
      "lr_attention": 0.01939692735671997,
      "lr_ffn": 0.01939692735671997,
      "lr_norm": 0.0002909539103507995
    },
    {
      "step": 6,
      "train_loss": 9.902795314788818,
      "tokens_per_sec": 86048.8558069646,
      "lr_embedding": 0.00026490672826766967,
      "lr_attention": 0.01766044855117798,
      "lr_ffn": 0.01766044855117798,
      "lr_norm": 0.00026490672826766967
    },
    {
      "step": 8,
      "train_loss": 9.59016227722168,
      "tokens_per_sec": 86703.08350408285,
      "lr_embedding": 0.0002250001162290573,
      "lr_attention": 0.01500000774860382,
      "lr_ffn": 0.01500000774860382,
      "lr_norm": 0.0002250001162290573
    },
    {
      "step": 10,
      "train_loss": 9.364681720733643,
      "tokens_per_sec": 86502.37560594293,
      "lr_embedding": 0.00017604740783572196,
      "lr_attention": 0.011736493855714798,
      "lr_ffn": 0.011736493855714798,
      "lr_norm": 0.00017604740783572196,
      "token_embedding.weight_spectral": 7.20736026763916,
      "layers.0.attention.qkv.weight_spectral": 1.1327457427978516,
      "layers.0.attention.out_proj.weight_spectral": 0.8050254583358765,
      "layers.0.feed_forward.w1.weight_spectral": 1.2371845245361328,
      "layers.0.feed_forward.w2.weight_spectral": 1.203051209449768,
      "layers.0.feed_forward.w3.weight_spectral": 1.218193531036377,
      "layers.1.attention.qkv.weight_spectral": 1.0978801250457764,
      "layers.1.attention.out_proj.weight_spectral": 0.8201134204864502,
      "layers.1.feed_forward.w1.weight_spectral": 1.2493922710418701,
      "layers.1.feed_forward.w2.weight_spectral": 1.194890022277832,
      "layers.1.feed_forward.w3.weight_spectral": 1.2562317848205566,
      "layers.2.attention.qkv.weight_spectral": 1.098315954208374,
      "layers.2.attention.out_proj.weight_spectral": 0.7855628728866577,
      "layers.2.feed_forward.w1.weight_spectral": 1.2410674095153809,
      "layers.2.feed_forward.w2.weight_spectral": 1.2045423984527588,
      "layers.2.feed_forward.w3.weight_spectral": 1.2653628587722778,
      "layers.3.attention.qkv.weight_spectral": 1.1168015003204346,
      "layers.3.attention.out_proj.weight_spectral": 0.7997467517852783,
      "layers.3.feed_forward.w1.weight_spectral": 1.2599397897720337,
      "layers.3.feed_forward.w2.weight_spectral": 1.2235076427459717,
      "layers.3.feed_forward.w3.weight_spectral": 1.228713035583496,
      "embedding_frob_mean": 100.51337432861328,
      "embedding_frob_max": 100.51337432861328,
      "attention_frob_mean": 14.094901442527771,
      "attention_frob_max": 18.231740951538086,
      "ffn_frob_mean": 21.038681825002033,
      "ffn_frob_max": 21.380531311035156,
      "norm_frob_mean": 22.62427626715766,
      "norm_frob_max": 22.63777732849121
    },
    {
      "step": 12,
      "train_loss": 9.10388994216919,
      "tokens_per_sec": 86493.99211579609,
      "lr_embedding": 0.00012395298331975937,
      "lr_attention": 0.008263532221317291,
      "lr_ffn": 0.008263532221317291,
      "lr_norm": 0.00012395298331975937
    },
    {
      "step": 14,
      "train_loss": 8.997560501098633,
      "tokens_per_sec": 86212.72919060786,
      "lr_embedding": 7.500024139881133e-05,
      "lr_attention": 0.00500001609325409,
      "lr_ffn": 0.00500001609325409,
      "lr_norm": 7.500024139881133e-05
    },
    {
      "step": 16,
      "train_loss": 8.873629093170166,
      "tokens_per_sec": 86690.72386548706,
      "lr_embedding": 3.509353995323181e-05,
      "lr_attention": 0.002339569330215454,
      "lr_ffn": 0.002339569330215454,
      "lr_norm": 3.509353995323181e-05
    },
    {
      "step": 18,
      "train_loss": 8.84632921218872,
      "tokens_per_sec": 86016.54346046488,
      "lr_embedding": 9.046232700347899e-06,
      "lr_attention": 0.0006030821800231934,
      "lr_ffn": 0.0006030821800231934,
      "lr_norm": 9.046232700347899e-06
    },
    {
      "step": 20,
      "train_loss": 8.804126739501953,
      "tokens_per_sec": 86536.79760536048,
      "lr_embedding": 0.0,
      "lr_attention": 0.0,
      "lr_ffn": 0.0,
      "lr_norm": 0.0,
      "token_embedding.weight_spectral": 11.974650382995605,
      "layers.0.attention.qkv.weight_spectral": 1.1521270275115967,
      "layers.0.attention.out_proj.weight_spectral": 0.8194667100906372,
      "layers.0.feed_forward.w1.weight_spectral": 1.2603886127471924,
      "layers.0.feed_forward.w2.weight_spectral": 1.2136588096618652,
      "layers.0.feed_forward.w3.weight_spectral": 1.2607977390289307,
      "layers.1.attention.qkv.weight_spectral": 1.1142871379852295,
      "layers.1.attention.out_proj.weight_spectral": 0.8012704849243164,
      "layers.1.feed_forward.w1.weight_spectral": 1.2978459596633911,
      "layers.1.feed_forward.w2.weight_spectral": 1.2179226875305176,
      "layers.1.feed_forward.w3.weight_spectral": 1.3012059926986694,
      "layers.2.attention.qkv.weight_spectral": 1.1301835775375366,
      "layers.2.attention.out_proj.weight_spectral": 0.7866078615188599,
      "layers.2.feed_forward.w1.weight_spectral": 1.2896515130996704,
      "layers.2.feed_forward.w2.weight_spectral": 1.1998602151870728,
      "layers.2.feed_forward.w3.weight_spectral": 1.2489566802978516,
      "layers.3.attention.qkv.weight_spectral": 1.1220650672912598,
      "layers.3.attention.out_proj.weight_spectral": 0.8204749822616577,
      "layers.3.feed_forward.w1.weight_spectral": 1.2790210247039795,
      "layers.3.feed_forward.w2.weight_spectral": 1.235483169555664,
      "layers.3.feed_forward.w3.weight_spectral": 1.2800902128219604,
      "embedding_frob_mean": 100.75741577148438,
      "embedding_frob_max": 100.75741577148438,
      "attention_frob_mean": 14.186315417289734,
      "attention_frob_max": 18.547996520996094,
      "ffn_frob_mean": 21.445723215738933,
      "ffn_frob_max": 21.991214752197266,
      "norm_frob_mean": 22.62533187866211,
      "norm_frob_max": 22.6513671875
    },
    {
      "step": 20,
      "val_loss": 8.736254692077637,
      "perplexity": 6224.5391849430425
    }
  ],
  "config": {
    "name": "baseline",
    "description": "Muon for 2D weight matrices, AdamW for embeddings & norms",
    "max_steps": 20,
    "batch_size": 16,
    "hidden_size": 512,
    "num_layers": 4,
    "embedding_optimizer": "adamw",
    "embedding_lr": 0.0003,
    "attention_optimizer": "muon",
    "attention_lr": 0.02,
    "ffn_optimizer": "muon",
    "ffn_lr": 0.02
  },
  "final_val_loss": 8.745221797456132,
  "final_perplexity": 6280.606287866051,
  "end_time": "2025-12-06T08:17:35.851607"
}