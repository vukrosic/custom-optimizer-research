{
  "experiment_name": "sphere_constraint",
  "start_time": "2025-12-06T08:17:36.183944",
  "steps": [
    {
      "step": 2,
      "train_loss": 10.950828075408936,
      "tokens_per_sec": 75870.58263133373,
      "lr_embedding": 0.0003,
      "lr_attention": 0.02,
      "lr_ffn": 0.02,
      "lr_norm": 0.0003
    },
    {
      "step": 4,
      "train_loss": 10.107119083404541,
      "tokens_per_sec": 80892.59958446879,
      "lr_embedding": 0.0002909539103507995,
      "lr_attention": 0.01939692735671997,
      "lr_ffn": 0.01939692735671997,
      "lr_norm": 0.0002909539103507995
    },
    {
      "step": 6,
      "train_loss": 9.491143703460693,
      "tokens_per_sec": 86345.31949519267,
      "lr_embedding": 0.00026490672826766967,
      "lr_attention": 0.01766044855117798,
      "lr_ffn": 0.01766044855117798,
      "lr_norm": 0.00026490672826766967
    },
    {
      "step": 8,
      "train_loss": 9.163514137268066,
      "tokens_per_sec": 86101.90064125856,
      "lr_embedding": 0.0002250001162290573,
      "lr_attention": 0.01500000774860382,
      "lr_ffn": 0.01500000774860382,
      "lr_norm": 0.0002250001162290573
    },
    {
      "step": 10,
      "train_loss": 8.924280643463135,
      "tokens_per_sec": 85941.34975469261,
      "lr_embedding": 0.00017604740783572196,
      "lr_attention": 0.011736493855714798,
      "lr_ffn": 0.011736493855714798,
      "lr_norm": 0.00017604740783572196,
      "token_embedding.weight_spectral": 10.023884773254395,
      "layers.0.attention.qkv.weight_spectral": 1.1297928094863892,
      "layers.0.attention.out_proj.weight_spectral": 0.7974019050598145,
      "layers.0.feed_forward.w1.weight_spectral": 1.2319178581237793,
      "layers.0.feed_forward.w2.weight_spectral": 1.20760178565979,
      "layers.0.feed_forward.w3.weight_spectral": 1.212472915649414,
      "layers.1.attention.qkv.weight_spectral": 1.1005401611328125,
      "layers.1.attention.out_proj.weight_spectral": 0.8240877389907837,
      "layers.1.feed_forward.w1.weight_spectral": 1.2379810810089111,
      "layers.1.feed_forward.w2.weight_spectral": 1.1932120323181152,
      "layers.1.feed_forward.w3.weight_spectral": 1.2407920360565186,
      "layers.2.attention.qkv.weight_spectral": 1.1006314754486084,
      "layers.2.attention.out_proj.weight_spectral": 0.7896915078163147,
      "layers.2.feed_forward.w1.weight_spectral": 1.2306208610534668,
      "layers.2.feed_forward.w2.weight_spectral": 1.2039172649383545,
      "layers.2.feed_forward.w3.weight_spectral": 1.2465391159057617,
      "layers.3.attention.qkv.weight_spectral": 1.1162097454071045,
      "layers.3.attention.out_proj.weight_spectral": 0.8009386658668518,
      "layers.3.feed_forward.w1.weight_spectral": 1.2506961822509766,
      "layers.3.feed_forward.w2.weight_spectral": 1.2214577198028564,
      "layers.3.feed_forward.w3.weight_spectral": 1.23655104637146,
      "embedding_frob_mean": 221.70249938964844,
      "embedding_frob_max": 221.70249938964844,
      "attention_frob_mean": 14.098066449165344,
      "attention_frob_max": 18.17509651184082,
      "ffn_frob_mean": 20.929662863413494,
      "ffn_frob_max": 21.26870346069336,
      "norm_frob_mean": 22.62231996324327,
      "norm_frob_max": 22.63645362854004
    },
    {
      "step": 12,
      "train_loss": 8.623948574066162,
      "tokens_per_sec": 85988.12866284439,
      "lr_embedding": 0.00012395298331975937,
      "lr_attention": 0.008263532221317291,
      "lr_ffn": 0.008263532221317291,
      "lr_norm": 0.00012395298331975937
    },
    {
      "step": 14,
      "train_loss": 8.552831649780273,
      "tokens_per_sec": 86136.00459261822,
      "lr_embedding": 7.500024139881133e-05,
      "lr_attention": 0.00500001609325409,
      "lr_ffn": 0.00500001609325409,
      "lr_norm": 7.500024139881133e-05
    },
    {
      "step": 16,
      "train_loss": 8.422897815704346,
      "tokens_per_sec": 85784.6090054552,
      "lr_embedding": 3.509353995323181e-05,
      "lr_attention": 0.002339569330215454,
      "lr_ffn": 0.002339569330215454,
      "lr_norm": 3.509353995323181e-05
    },
    {
      "step": 18,
      "train_loss": 8.389759540557861,
      "tokens_per_sec": 86206.78085221421,
      "lr_embedding": 9.046232700347899e-06,
      "lr_attention": 0.0006030821800231934,
      "lr_ffn": 0.0006030821800231934,
      "lr_norm": 9.046232700347899e-06
    },
    {
      "step": 20,
      "train_loss": 8.33447265625,
      "tokens_per_sec": 85317.48070161499,
      "lr_embedding": 0.0,
      "lr_attention": 0.0,
      "lr_ffn": 0.0,
      "lr_norm": 0.0,
      "token_embedding.weight_spectral": 10.737180709838867,
      "layers.0.attention.qkv.weight_spectral": 1.1353154182434082,
      "layers.0.attention.out_proj.weight_spectral": 0.8128833770751953,
      "layers.0.feed_forward.w1.weight_spectral": 1.262411117553711,
      "layers.0.feed_forward.w2.weight_spectral": 1.208467721939087,
      "layers.0.feed_forward.w3.weight_spectral": 1.2308045625686646,
      "layers.1.attention.qkv.weight_spectral": 1.1240214109420776,
      "layers.1.attention.out_proj.weight_spectral": 0.798209547996521,
      "layers.1.feed_forward.w1.weight_spectral": 1.2634578943252563,
      "layers.1.feed_forward.w2.weight_spectral": 1.218135118484497,
      "layers.1.feed_forward.w3.weight_spectral": 1.2731462717056274,
      "layers.2.attention.qkv.weight_spectral": 1.1246060132980347,
      "layers.2.attention.out_proj.weight_spectral": 0.7919151782989502,
      "layers.2.feed_forward.w1.weight_spectral": 1.2652113437652588,
      "layers.2.feed_forward.w2.weight_spectral": 1.194605827331543,
      "layers.2.feed_forward.w3.weight_spectral": 1.2502518892288208,
      "layers.3.attention.qkv.weight_spectral": 1.125784993171692,
      "layers.3.attention.out_proj.weight_spectral": 0.816880464553833,
      "layers.3.feed_forward.w1.weight_spectral": 1.2696484327316284,
      "layers.3.feed_forward.w2.weight_spectral": 1.2288293838500977,
      "layers.3.feed_forward.w3.weight_spectral": 1.273921012878418,
      "embedding_frob_mean": 221.70249938964844,
      "embedding_frob_max": 221.70249938964844,
      "attention_frob_mean": 14.15172290802002,
      "attention_frob_max": 18.362548828125,
      "ffn_frob_mean": 21.20311180750529,
      "ffn_frob_max": 21.705289840698242,
      "norm_frob_mean": 22.62304221259223,
      "norm_frob_max": 22.64694595336914
    },
    {
      "step": 20,
      "val_loss": 8.24805727005005,
      "perplexity": 3820.196996556176
    }
  ],
  "config": {
    "name": "sphere_constraint",
    "description": "Baseline + hypersphere constraint on embeddings (unit norm rows)",
    "max_steps": 20,
    "batch_size": 16,
    "hidden_size": 512,
    "num_layers": 4,
    "embedding_optimizer": "adamw",
    "embedding_lr": 0.0003,
    "attention_optimizer": "muon",
    "attention_lr": 0.02,
    "ffn_optimizer": "muon",
    "ffn_lr": 0.02
  },
  "final_val_loss": 8.272339815789081,
  "final_perplexity": 3914.096551089444,
  "end_time": "2025-12-06T08:18:28.415235"
}