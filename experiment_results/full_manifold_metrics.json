{
  "experiment_name": "full_manifold",
  "start_time": "2025-12-06T08:39:24.524697",
  "steps": [
    {
      "step": 20,
      "train_loss": 10.057305288314819,
      "tokens_per_sec": 57133.7279758693,
      "lr_embedding": 0.0003,
      "lr_attention": 0.02,
      "lr_ffn": 0.02,
      "lr_norm": 0.0003
    },
    {
      "step": 40,
      "train_loss": 8.062231731414794,
      "tokens_per_sec": 57795.24493907189,
      "lr_embedding": 0.0002909539103507995,
      "lr_attention": 0.01939692735671997,
      "lr_ffn": 0.01939692735671997,
      "lr_norm": 0.0002909539103507995
    },
    {
      "step": 60,
      "train_loss": 7.391346287727356,
      "tokens_per_sec": 57561.47300193911,
      "lr_embedding": 0.00026490672826766967,
      "lr_attention": 0.01766044855117798,
      "lr_ffn": 0.01766044855117798,
      "lr_norm": 0.00026490672826766967
    },
    {
      "step": 80,
      "train_loss": 7.146873259544373,
      "tokens_per_sec": 57429.64187348083,
      "lr_embedding": 0.0002250001162290573,
      "lr_attention": 0.01500000774860382,
      "lr_ffn": 0.01500000774860382,
      "lr_norm": 0.0002250001162290573
    },
    {
      "step": 100,
      "train_loss": 6.973170304298401,
      "tokens_per_sec": 57313.189219700675,
      "lr_embedding": 0.00017604740783572196,
      "lr_attention": 0.011736493855714798,
      "lr_ffn": 0.011736493855714798,
      "lr_norm": 0.00017604740783572196,
      "token_embedding.weight_spectral": 50.4909553527832,
      "layers.0.attention.qkv.weight_spectral": 1.0678445100784302,
      "layers.0.attention.out_proj.weight_spectral": 1.0713162422180176,
      "layers.0.feed_forward.w1.weight_spectral": 1.06651771068573,
      "layers.0.feed_forward.w2.weight_spectral": 1.0705398321151733,
      "layers.0.feed_forward.w3.weight_spectral": 1.067752718925476,
      "layers.1.attention.qkv.weight_spectral": 1.0690362453460693,
      "layers.1.attention.out_proj.weight_spectral": 1.0714759826660156,
      "layers.1.feed_forward.w1.weight_spectral": 1.0675780773162842,
      "layers.1.feed_forward.w2.weight_spectral": 1.071091890335083,
      "layers.1.feed_forward.w3.weight_spectral": 1.0678749084472656,
      "layers.2.attention.qkv.weight_spectral": 1.069215178489685,
      "layers.2.attention.out_proj.weight_spectral": 1.071089506149292,
      "layers.2.feed_forward.w1.weight_spectral": 1.068450689315796,
      "layers.2.feed_forward.w2.weight_spectral": 1.0703372955322266,
      "layers.2.feed_forward.w3.weight_spectral": 1.0675990581512451,
      "layers.3.attention.qkv.weight_spectral": 1.0685805082321167,
      "layers.3.attention.out_proj.weight_spectral": 1.0694098472595215,
      "layers.3.feed_forward.w1.weight_spectral": 1.0690834522247314,
      "layers.3.feed_forward.w2.weight_spectral": 1.0696195363998413,
      "layers.3.feed_forward.w3.weight_spectral": 1.0675352811813354,
      "embedding_frob_mean": 221.70249938964844,
      "embedding_frob_max": 221.70249938964844,
      "attention_frob_mean": 21.41993284225464,
      "attention_frob_max": 21.443429946899414,
      "ffn_frob_mean": 21.412485281626385,
      "ffn_frob_max": 21.447019577026367,
      "norm_frob_mean": 22.665543450249565,
      "norm_frob_max": 22.93816566467285
    },
    {
      "step": 120,
      "train_loss": 6.871073436737061,
      "tokens_per_sec": 57016.48415859764,
      "lr_embedding": 0.00012395298331975937,
      "lr_attention": 0.008263532221317291,
      "lr_ffn": 0.008263532221317291,
      "lr_norm": 0.00012395298331975937
    },
    {
      "step": 140,
      "train_loss": 6.695621132850647,
      "tokens_per_sec": 56964.9713622839,
      "lr_embedding": 7.500024139881133e-05,
      "lr_attention": 0.00500001609325409,
      "lr_ffn": 0.00500001609325409,
      "lr_norm": 7.500024139881133e-05
    },
    {
      "step": 160,
      "train_loss": 6.669096732139588,
      "tokens_per_sec": 56811.04161093267,
      "lr_embedding": 3.509353995323181e-05,
      "lr_attention": 0.002339569330215454,
      "lr_ffn": 0.002339569330215454,
      "lr_norm": 3.509353995323181e-05
    },
    {
      "step": 180,
      "train_loss": 6.628758811950684,
      "tokens_per_sec": 56740.91846180408,
      "lr_embedding": 9.046232700347899e-06,
      "lr_attention": 0.0006030821800231934,
      "lr_ffn": 0.0006030821800231934,
      "lr_norm": 9.046232700347899e-06
    },
    {
      "step": 200,
      "train_loss": 6.6181916236877445,
      "tokens_per_sec": 56742.530159767935,
      "lr_embedding": 0.0,
      "lr_attention": 0.0,
      "lr_ffn": 0.0,
      "lr_norm": 0.0,
      "token_embedding.weight_spectral": 59.43173599243164,
      "layers.0.attention.qkv.weight_spectral": 1.0696110725402832,
      "layers.0.attention.out_proj.weight_spectral": 1.070847511291504,
      "layers.0.feed_forward.w1.weight_spectral": 1.0710381269454956,
      "layers.0.feed_forward.w2.weight_spectral": 1.0695719718933105,
      "layers.0.feed_forward.w3.weight_spectral": 1.0715484619140625,
      "layers.1.attention.qkv.weight_spectral": 1.070417881011963,
      "layers.1.attention.out_proj.weight_spectral": 1.073232650756836,
      "layers.1.feed_forward.w1.weight_spectral": 1.072229266166687,
      "layers.1.feed_forward.w2.weight_spectral": 1.0701795816421509,
      "layers.1.feed_forward.w3.weight_spectral": 1.071197509765625,
      "layers.2.attention.qkv.weight_spectral": 1.0694135427474976,
      "layers.2.attention.out_proj.weight_spectral": 1.0723083019256592,
      "layers.2.feed_forward.w1.weight_spectral": 1.0699790716171265,
      "layers.2.feed_forward.w2.weight_spectral": 1.0712417364120483,
      "layers.2.feed_forward.w3.weight_spectral": 1.070472240447998,
      "layers.3.attention.qkv.weight_spectral": 1.0705684423446655,
      "layers.3.attention.out_proj.weight_spectral": 1.0714874267578125,
      "layers.3.feed_forward.w1.weight_spectral": 1.0711743831634521,
      "layers.3.feed_forward.w2.weight_spectral": 1.0697474479675293,
      "layers.3.feed_forward.w3.weight_spectral": 1.0712416172027588,
      "embedding_frob_mean": 221.70249938964844,
      "embedding_frob_max": 221.70249938964844,
      "attention_frob_mean": 21.440129041671753,
      "attention_frob_max": 21.472415924072266,
      "ffn_frob_mean": 21.4537771542867,
      "ffn_frob_max": 21.460800170898438,
      "norm_frob_mean": 22.674999448988174,
      "norm_frob_max": 23.001466751098633
    },
    {
      "step": 200,
      "val_loss": 6.533111333847046,
      "perplexity": 687.5340350530286
    }
  ],
  "config": {
    "name": "full_manifold",
    "description": "Sphere for embeddings + Stiefel manifold for attention & FFN",
    "max_steps": 200,
    "batch_size": 16,
    "hidden_size": 512,
    "num_layers": 4,
    "embedding_optimizer": "adamw",
    "embedding_lr": 0.0003,
    "attention_optimizer": "muon",
    "attention_lr": 0.02,
    "ffn_optimizer": "muon",
    "ffn_lr": 0.02
  },
  "final_val_loss": 6.538238690254536,
  "final_perplexity": 691.0683201196539,
  "end_time": "2025-12-06T08:40:42.524382"
}