{
  "experiment_name": "manifold_muon",
  "start_time": "2025-12-06T08:40:42.874992",
  "steps": [
    {
      "step": 20,
      "train_loss": 10.151532459259034,
      "tokens_per_sec": 57221.12606071597,
      "lr_embedding": 0.0003,
      "lr_attention": 0.02,
      "lr_ffn": 0.02,
      "lr_norm": 0.0003
    },
    {
      "step": 40,
      "train_loss": 8.209855484962464,
      "tokens_per_sec": 57803.98591126465,
      "lr_embedding": 0.0002909539103507995,
      "lr_attention": 0.01939692735671997,
      "lr_ffn": 0.01939692735671997,
      "lr_norm": 0.0002909539103507995
    },
    {
      "step": 60,
      "train_loss": 7.510430550575256,
      "tokens_per_sec": 57576.41877142951,
      "lr_embedding": 0.00026490672826766967,
      "lr_attention": 0.01766044855117798,
      "lr_ffn": 0.01766044855117798,
      "lr_norm": 0.00026490672826766967
    },
    {
      "step": 80,
      "train_loss": 7.268236804008484,
      "tokens_per_sec": 57416.17294898962,
      "lr_embedding": 0.0002250001162290573,
      "lr_attention": 0.01500000774860382,
      "lr_ffn": 0.01500000774860382,
      "lr_norm": 0.0002250001162290573
    },
    {
      "step": 100,
      "train_loss": 7.06325261592865,
      "tokens_per_sec": 57224.03265791751,
      "lr_embedding": 0.00017604740783572196,
      "lr_attention": 0.011736493855714798,
      "lr_ffn": 0.011736493855714798,
      "lr_norm": 0.00017604740783572196,
      "token_embedding.weight_spectral": 53.84391784667969,
      "layers.0.attention.qkv.weight_spectral": 1.0687605142593384,
      "layers.0.attention.out_proj.weight_spectral": 1.0692416429519653,
      "layers.0.feed_forward.w1.weight_spectral": 1.0680636167526245,
      "layers.0.feed_forward.w2.weight_spectral": 1.070662498474121,
      "layers.0.feed_forward.w3.weight_spectral": 1.066864252090454,
      "layers.1.attention.qkv.weight_spectral": 1.0676349401474,
      "layers.1.attention.out_proj.weight_spectral": 1.0712151527404785,
      "layers.1.feed_forward.w1.weight_spectral": 1.0667529106140137,
      "layers.1.feed_forward.w2.weight_spectral": 1.0705422163009644,
      "layers.1.feed_forward.w3.weight_spectral": 1.0675950050354004,
      "layers.2.attention.qkv.weight_spectral": 1.0668953657150269,
      "layers.2.attention.out_proj.weight_spectral": 1.0702099800109863,
      "layers.2.feed_forward.w1.weight_spectral": 1.0671989917755127,
      "layers.2.feed_forward.w2.weight_spectral": 1.070430874824524,
      "layers.2.feed_forward.w3.weight_spectral": 1.0671793222427368,
      "layers.3.attention.qkv.weight_spectral": 1.0688246488571167,
      "layers.3.attention.out_proj.weight_spectral": 1.070143461227417,
      "layers.3.feed_forward.w1.weight_spectral": 1.0672276020050049,
      "layers.3.feed_forward.w2.weight_spectral": 1.0686124563217163,
      "layers.3.feed_forward.w3.weight_spectral": 1.0683882236480713,
      "embedding_frob_mean": 113.67867279052734,
      "embedding_frob_max": 113.67867279052734,
      "attention_frob_mean": 21.4202778339386,
      "attention_frob_max": 21.444040298461914,
      "ffn_frob_mean": 21.40822108586629,
      "ffn_frob_max": 21.445791244506836,
      "norm_frob_mean": 22.697945064968533,
      "norm_frob_max": 22.972379684448242
    },
    {
      "step": 120,
      "train_loss": 6.941663146018982,
      "tokens_per_sec": 57080.94586306183,
      "lr_embedding": 0.00012395298331975937,
      "lr_attention": 0.008263532221317291,
      "lr_ffn": 0.008263532221317291,
      "lr_norm": 0.00012395298331975937
    },
    {
      "step": 140,
      "train_loss": 6.761578559875488,
      "tokens_per_sec": 56863.66430190798,
      "lr_embedding": 7.500024139881133e-05,
      "lr_attention": 0.00500001609325409,
      "lr_ffn": 0.00500001609325409,
      "lr_norm": 7.500024139881133e-05
    },
    {
      "step": 160,
      "train_loss": 6.725159645080566,
      "tokens_per_sec": 56873.598983285636,
      "lr_embedding": 3.509353995323181e-05,
      "lr_attention": 0.002339569330215454,
      "lr_ffn": 0.002339569330215454,
      "lr_norm": 3.509353995323181e-05
    },
    {
      "step": 180,
      "train_loss": 6.685117387771607,
      "tokens_per_sec": 56712.34945240641,
      "lr_embedding": 9.046232700347899e-06,
      "lr_attention": 0.0006030821800231934,
      "lr_ffn": 0.0006030821800231934,
      "lr_norm": 9.046232700347899e-06
    },
    {
      "step": 200,
      "train_loss": 6.671108269691468,
      "tokens_per_sec": 56746.33019381926,
      "lr_embedding": 0.0,
      "lr_attention": 0.0,
      "lr_ffn": 0.0,
      "lr_norm": 0.0,
      "token_embedding.weight_spectral": 64.25575256347656,
      "layers.0.attention.qkv.weight_spectral": 1.0689804553985596,
      "layers.0.attention.out_proj.weight_spectral": 1.0707250833511353,
      "layers.0.feed_forward.w1.weight_spectral": 1.0704885721206665,
      "layers.0.feed_forward.w2.weight_spectral": 1.069799542427063,
      "layers.0.feed_forward.w3.weight_spectral": 1.071021318435669,
      "layers.1.attention.qkv.weight_spectral": 1.0706791877746582,
      "layers.1.attention.out_proj.weight_spectral": 1.0729459524154663,
      "layers.1.feed_forward.w1.weight_spectral": 1.0714585781097412,
      "layers.1.feed_forward.w2.weight_spectral": 1.070299744606018,
      "layers.1.feed_forward.w3.weight_spectral": 1.0706157684326172,
      "layers.2.attention.qkv.weight_spectral": 1.0673341751098633,
      "layers.2.attention.out_proj.weight_spectral": 1.0726730823516846,
      "layers.2.feed_forward.w1.weight_spectral": 1.068557858467102,
      "layers.2.feed_forward.w2.weight_spectral": 1.0710747241973877,
      "layers.2.feed_forward.w3.weight_spectral": 1.071938157081604,
      "layers.3.attention.qkv.weight_spectral": 1.0696437358856201,
      "layers.3.attention.out_proj.weight_spectral": 1.0714998245239258,
      "layers.3.feed_forward.w1.weight_spectral": 1.0716991424560547,
      "layers.3.feed_forward.w2.weight_spectral": 1.0700336694717407,
      "layers.3.feed_forward.w3.weight_spectral": 1.0697667598724365,
      "embedding_frob_mean": 118.98381042480469,
      "embedding_frob_max": 118.98381042480469,
      "attention_frob_mean": 21.441802263259888,
      "attention_frob_max": 21.472414016723633,
      "ffn_frob_mean": 21.452778816223145,
      "ffn_frob_max": 21.46080207824707,
      "norm_frob_mean": 22.72296863132053,
      "norm_frob_max": 23.10141372680664
    },
    {
      "step": 200,
      "val_loss": 6.612826633453369,
      "perplexity": 744.5847150190701
    }
  ],
  "config": {
    "name": "manifold_muon",
    "description": "Muon optimizer + Stiefel constraint (no sphere embeddings)",
    "max_steps": 200,
    "batch_size": 16,
    "hidden_size": 512,
    "num_layers": 4,
    "embedding_optimizer": "adamw",
    "embedding_lr": 0.0003,
    "attention_optimizer": "muon",
    "attention_lr": 0.02,
    "ffn_optimizer": "muon",
    "ffn_lr": 0.02
  },
  "final_val_loss": 6.614775802226776,
  "final_perplexity": 746.037451649236,
  "end_time": "2025-12-06T08:42:01.816858"
}