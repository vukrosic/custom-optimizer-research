{
  "experiment_name": "sphere_constraint",
  "start_time": "2025-12-06T08:35:46.631143",
  "steps": [
    {
      "step": 20,
      "train_loss": 9.658446645736694,
      "tokens_per_sec": 85859.04583036338,
      "lr_embedding": 0.0003,
      "lr_attention": 0.02,
      "lr_ffn": 0.02,
      "lr_norm": 0.0003
    },
    {
      "step": 40,
      "train_loss": 7.629608750343323,
      "tokens_per_sec": 86025.26540223252,
      "lr_embedding": 0.0002909539103507995,
      "lr_attention": 0.01939692735671997,
      "lr_ffn": 0.01939692735671997,
      "lr_norm": 0.0002909539103507995
    },
    {
      "step": 60,
      "train_loss": 6.99868266582489,
      "tokens_per_sec": 85788.65710517006,
      "lr_embedding": 0.00026490672826766967,
      "lr_attention": 0.01766044855117798,
      "lr_ffn": 0.01766044855117798,
      "lr_norm": 0.00026490672826766967
    },
    {
      "step": 80,
      "train_loss": 6.816327357292176,
      "tokens_per_sec": 85683.19933926678,
      "lr_embedding": 0.0002250001162290573,
      "lr_attention": 0.01500000774860382,
      "lr_ffn": 0.01500000774860382,
      "lr_norm": 0.0002250001162290573
    },
    {
      "step": 100,
      "train_loss": 6.658066940307617,
      "tokens_per_sec": 85766.77193228567,
      "lr_embedding": 0.00017604740783572196,
      "lr_attention": 0.011736493855714798,
      "lr_ffn": 0.011736493855714798,
      "lr_norm": 0.00017604740783572196,
      "token_embedding.weight_spectral": 53.3743782043457,
      "layers.0.attention.qkv.weight_spectral": 1.6646904945373535,
      "layers.0.attention.out_proj.weight_spectral": 0.9275569915771484,
      "layers.0.feed_forward.w1.weight_spectral": 2.4565701484680176,
      "layers.0.feed_forward.w2.weight_spectral": 1.5786387920379639,
      "layers.0.feed_forward.w3.weight_spectral": 2.502908706665039,
      "layers.1.attention.qkv.weight_spectral": 2.3458590507507324,
      "layers.1.attention.out_proj.weight_spectral": 1.202391505241394,
      "layers.1.feed_forward.w1.weight_spectral": 2.4247522354125977,
      "layers.1.feed_forward.w2.weight_spectral": 1.5213006734848022,
      "layers.1.feed_forward.w3.weight_spectral": 2.4039454460144043,
      "layers.2.attention.qkv.weight_spectral": 2.265468120574951,
      "layers.2.attention.out_proj.weight_spectral": 1.2374014854431152,
      "layers.2.feed_forward.w1.weight_spectral": 2.4358577728271484,
      "layers.2.feed_forward.w2.weight_spectral": 1.5084431171417236,
      "layers.2.feed_forward.w3.weight_spectral": 2.4151554107666016,
      "layers.3.attention.qkv.weight_spectral": 2.323268413543701,
      "layers.3.attention.out_proj.weight_spectral": 1.3257606029510498,
      "layers.3.feed_forward.w1.weight_spectral": 2.4805264472961426,
      "layers.3.feed_forward.w2.weight_spectral": 1.5822727680206299,
      "layers.3.feed_forward.w3.weight_spectral": 2.440995693206787,
      "embedding_frob_mean": 221.70249938964844,
      "embedding_frob_max": 221.70249938964844,
      "attention_frob_mean": 23.744513511657715,
      "attention_frob_max": 34.010623931884766,
      "ffn_frob_mean": 36.20156955718994,
      "ffn_frob_max": 43.3178825378418,
      "norm_frob_mean": 22.626413981119793,
      "norm_frob_max": 22.83011817932129
    },
    {
      "step": 120,
      "train_loss": 6.575412726402282,
      "tokens_per_sec": 85653.37085225503,
      "lr_embedding": 0.00012395298331975937,
      "lr_attention": 0.008263532221317291,
      "lr_ffn": 0.008263532221317291,
      "lr_norm": 0.00012395298331975937
    },
    {
      "step": 140,
      "train_loss": 6.402693200111389,
      "tokens_per_sec": 85603.98008720661,
      "lr_embedding": 7.500024139881133e-05,
      "lr_attention": 0.00500001609325409,
      "lr_ffn": 0.00500001609325409,
      "lr_norm": 7.500024139881133e-05
    },
    {
      "step": 160,
      "train_loss": 6.377929759025574,
      "tokens_per_sec": 85528.1005087293,
      "lr_embedding": 3.509353995323181e-05,
      "lr_attention": 0.002339569330215454,
      "lr_ffn": 0.002339569330215454,
      "lr_norm": 3.509353995323181e-05
    },
    {
      "step": 180,
      "train_loss": 6.334316325187683,
      "tokens_per_sec": 85414.51179740996,
      "lr_embedding": 9.046232700347899e-06,
      "lr_attention": 0.0006030821800231934,
      "lr_ffn": 0.0006030821800231934,
      "lr_norm": 9.046232700347899e-06
    },
    {
      "step": 200,
      "train_loss": 6.322484564781189,
      "tokens_per_sec": 85305.3434869644,
      "lr_embedding": 0.0,
      "lr_attention": 0.0,
      "lr_ffn": 0.0,
      "lr_norm": 0.0,
      "token_embedding.weight_spectral": 62.22721862792969,
      "layers.0.attention.qkv.weight_spectral": 1.6784498691558838,
      "layers.0.attention.out_proj.weight_spectral": 0.9157211780548096,
      "layers.0.feed_forward.w1.weight_spectral": 2.7407963275909424,
      "layers.0.feed_forward.w2.weight_spectral": 1.6892633438110352,
      "layers.0.feed_forward.w3.weight_spectral": 2.6630868911743164,
      "layers.1.attention.qkv.weight_spectral": 2.239377021789551,
      "layers.1.attention.out_proj.weight_spectral": 1.500659465789795,
      "layers.1.feed_forward.w1.weight_spectral": 2.638151168823242,
      "layers.1.feed_forward.w2.weight_spectral": 1.6306086778640747,
      "layers.1.feed_forward.w3.weight_spectral": 2.5435097217559814,
      "layers.2.attention.qkv.weight_spectral": 2.347935676574707,
      "layers.2.attention.out_proj.weight_spectral": 1.5269629955291748,
      "layers.2.feed_forward.w1.weight_spectral": 2.6144566535949707,
      "layers.2.feed_forward.w2.weight_spectral": 1.627896785736084,
      "layers.2.feed_forward.w3.weight_spectral": 2.714712142944336,
      "layers.3.attention.qkv.weight_spectral": 2.3974742889404297,
      "layers.3.attention.out_proj.weight_spectral": 1.4423013925552368,
      "layers.3.feed_forward.w1.weight_spectral": 2.6662347316741943,
      "layers.3.feed_forward.w2.weight_spectral": 1.6598072052001953,
      "layers.3.feed_forward.w3.weight_spectral": 2.708479642868042,
      "embedding_frob_mean": 221.70249938964844,
      "embedding_frob_max": 221.70249938964844,
      "attention_frob_mean": 24.965955138206482,
      "attention_frob_max": 36.53851318359375,
      "ffn_frob_mean": 38.43238910039266,
      "ffn_frob_max": 47.039066314697266,
      "norm_frob_mean": 22.626000934176975,
      "norm_frob_max": 22.882530212402344
    },
    {
      "step": 200,
      "val_loss": 6.231362247467041,
      "perplexity": 508.4476434566011
    }
  ],
  "config": {
    "name": "sphere_constraint",
    "description": "Baseline + hypersphere constraint on embeddings (unit norm rows)",
    "max_steps": 200,
    "batch_size": 16,
    "hidden_size": 512,
    "num_layers": 4,
    "embedding_optimizer": "adamw",
    "embedding_lr": 0.0003,
    "attention_optimizer": "muon",
    "attention_lr": 0.02,
    "ffn_optimizer": "muon",
    "ffn_lr": 0.02
  },
  "final_val_loss": 6.239721206908531,
  "final_perplexity": 512.7155494623394,
  "end_time": "2025-12-06T08:36:55.034401"
}