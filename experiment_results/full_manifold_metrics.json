{
  "experiment_name": "full_manifold",
  "start_time": "2025-12-06T08:20:12.751458",
  "steps": [
    {
      "step": 2,
      "train_loss": 11.124216556549072,
      "tokens_per_sec": 51789.4918501771,
      "lr_embedding": 0.0003,
      "lr_attention": 0.02,
      "lr_ffn": 0.02,
      "lr_norm": 0.0003
    },
    {
      "step": 4,
      "train_loss": 10.511579513549805,
      "tokens_per_sec": 57822.23963260048,
      "lr_embedding": 0.0002909539103507995,
      "lr_attention": 0.01939692735671997,
      "lr_ffn": 0.01939692735671997,
      "lr_norm": 0.0002909539103507995
    },
    {
      "step": 6,
      "train_loss": 9.958993911743164,
      "tokens_per_sec": 57969.64393444116,
      "lr_embedding": 0.00026490672826766967,
      "lr_attention": 0.01766044855117798,
      "lr_ffn": 0.01766044855117798,
      "lr_norm": 0.00026490672826766967
    },
    {
      "step": 8,
      "train_loss": 9.554323196411133,
      "tokens_per_sec": 57928.30284122281,
      "lr_embedding": 0.0002250001162290573,
      "lr_attention": 0.01500000774860382,
      "lr_ffn": 0.01500000774860382,
      "lr_norm": 0.0002250001162290573
    },
    {
      "step": 10,
      "train_loss": 9.32534408569336,
      "tokens_per_sec": 57749.788845264346,
      "lr_embedding": 0.00017604740783572196,
      "lr_attention": 0.011736493855714798,
      "lr_ffn": 0.011736493855714798,
      "lr_norm": 0.00017604740783572196,
      "token_embedding.weight_spectral": 10.029204368591309,
      "layers.0.attention.qkv.weight_spectral": 1.0684080123901367,
      "layers.0.attention.out_proj.weight_spectral": 1.0653754472732544,
      "layers.0.feed_forward.w1.weight_spectral": 1.0658247470855713,
      "layers.0.feed_forward.w2.weight_spectral": 1.0654834508895874,
      "layers.0.feed_forward.w3.weight_spectral": 1.0643045902252197,
      "layers.1.attention.qkv.weight_spectral": 1.0647761821746826,
      "layers.1.attention.out_proj.weight_spectral": 1.0690720081329346,
      "layers.1.feed_forward.w1.weight_spectral": 1.0648448467254639,
      "layers.1.feed_forward.w2.weight_spectral": 1.066999912261963,
      "layers.1.feed_forward.w3.weight_spectral": 1.0661463737487793,
      "layers.2.attention.qkv.weight_spectral": 1.0639922618865967,
      "layers.2.attention.out_proj.weight_spectral": 1.0668141841888428,
      "layers.2.feed_forward.w1.weight_spectral": 1.0656356811523438,
      "layers.2.feed_forward.w2.weight_spectral": 1.0646190643310547,
      "layers.2.feed_forward.w3.weight_spectral": 1.0644710063934326,
      "layers.3.attention.qkv.weight_spectral": 1.0652952194213867,
      "layers.3.attention.out_proj.weight_spectral": 1.065687656402588,
      "layers.3.feed_forward.w1.weight_spectral": 1.0652000904083252,
      "layers.3.feed_forward.w2.weight_spectral": 1.0663747787475586,
      "layers.3.feed_forward.w3.weight_spectral": 1.0653142929077148,
      "embedding_frob_mean": 221.70249938964844,
      "embedding_frob_max": 221.70249938964844,
      "attention_frob_mean": 21.388097047805786,
      "attention_frob_max": 21.42093276977539,
      "ffn_frob_mean": 21.374521096547443,
      "ffn_frob_max": 21.41156578063965,
      "norm_frob_mean": 22.625578986273872,
      "norm_frob_max": 22.64383888244629
    },
    {
      "step": 12,
      "train_loss": 9.05212116241455,
      "tokens_per_sec": 57695.19438357522,
      "lr_embedding": 0.00012395298331975937,
      "lr_attention": 0.008263532221317291,
      "lr_ffn": 0.008263532221317291,
      "lr_norm": 0.00012395298331975937
    },
    {
      "step": 14,
      "train_loss": 8.949079036712646,
      "tokens_per_sec": 57711.42617340601,
      "lr_embedding": 7.500024139881133e-05,
      "lr_attention": 0.00500001609325409,
      "lr_ffn": 0.00500001609325409,
      "lr_norm": 7.500024139881133e-05
    },
    {
      "step": 16,
      "train_loss": 8.82798719406128,
      "tokens_per_sec": 57732.61391272496,
      "lr_embedding": 3.509353995323181e-05,
      "lr_attention": 0.002339569330215454,
      "lr_ffn": 0.002339569330215454,
      "lr_norm": 3.509353995323181e-05
    },
    {
      "step": 18,
      "train_loss": 8.820262908935547,
      "tokens_per_sec": 57822.628859534205,
      "lr_embedding": 9.046232700347899e-06,
      "lr_attention": 0.0006030821800231934,
      "lr_ffn": 0.0006030821800231934,
      "lr_norm": 9.046232700347899e-06
    },
    {
      "step": 20,
      "train_loss": 8.75430965423584,
      "tokens_per_sec": 57956.1014070823,
      "lr_embedding": 0.0,
      "lr_attention": 0.0,
      "lr_ffn": 0.0,
      "lr_norm": 0.0,
      "token_embedding.weight_spectral": 10.140929222106934,
      "layers.0.attention.qkv.weight_spectral": 1.0704962015151978,
      "layers.0.attention.out_proj.weight_spectral": 1.0700525045394897,
      "layers.0.feed_forward.w1.weight_spectral": 1.0688014030456543,
      "layers.0.feed_forward.w2.weight_spectral": 1.0697473287582397,
      "layers.0.feed_forward.w3.weight_spectral": 1.0689619779586792,
      "layers.1.attention.qkv.weight_spectral": 1.0697734355926514,
      "layers.1.attention.out_proj.weight_spectral": 1.0728130340576172,
      "layers.1.feed_forward.w1.weight_spectral": 1.0706133842468262,
      "layers.1.feed_forward.w2.weight_spectral": 1.0713119506835938,
      "layers.1.feed_forward.w3.weight_spectral": 1.0727788209915161,
      "layers.2.attention.qkv.weight_spectral": 1.0673637390136719,
      "layers.2.attention.out_proj.weight_spectral": 1.0723882913589478,
      "layers.2.feed_forward.w1.weight_spectral": 1.0702948570251465,
      "layers.2.feed_forward.w2.weight_spectral": 1.069728970527649,
      "layers.2.feed_forward.w3.weight_spectral": 1.0705407857894897,
      "layers.3.attention.qkv.weight_spectral": 1.0701559782028198,
      "layers.3.attention.out_proj.weight_spectral": 1.0715258121490479,
      "layers.3.feed_forward.w1.weight_spectral": 1.070279598236084,
      "layers.3.feed_forward.w2.weight_spectral": 1.0708386898040771,
      "layers.3.feed_forward.w3.weight_spectral": 1.0713443756103516,
      "embedding_frob_mean": 221.70249938964844,
      "embedding_frob_max": 221.70249938964844,
      "attention_frob_mean": 21.439053058624268,
      "attention_frob_max": 21.47083854675293,
      "ffn_frob_mean": 21.450698852539062,
      "ffn_frob_max": 21.459346771240234,
      "norm_frob_mean": 22.626895480685764,
      "norm_frob_max": 22.653955459594727
    },
    {
      "step": 20,
      "val_loss": 8.706680297851562,
      "perplexity": 6043.147701729112
    }
  ],
  "config": {
    "name": "full_manifold",
    "description": "Sphere for embeddings + Stiefel manifold for attention & FFN",
    "max_steps": 20,
    "batch_size": 16,
    "hidden_size": 512,
    "num_layers": 4,
    "embedding_optimizer": "adamw",
    "embedding_lr": 0.0003,
    "attention_optimizer": "muon",
    "attention_lr": 0.02,
    "ffn_optimizer": "muon",
    "ffn_lr": 0.02
  },
  "final_val_loss": 8.715415310352407,
  "final_perplexity": 6096.165892619404,
  "end_time": "2025-12-06T08:21:04.571654"
}